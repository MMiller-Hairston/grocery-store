{"version":3,"file":"grocery-store.modern.js","sources":["../src/index.js"],"sourcesContent":["function createStore() {\n  let state = {};\n\n  function updateState(name, payload) {\n    const updatedState = {\n      ...state,\n      [name]: payload,\n    };\n    state = updatedState;\n  }\n\n  function getStore() {\n    return state;\n  }\n\n  function createCart(name, identifier = 'id', defaultValue = []) {\n    if (!name) {\n      throw new Error('Name is required for cart to be a part of the store');\n    }\n\n    if (name in state) {\n      throw new Error('Name should be unique');\n    }\n    let currentValue = defaultValue;\n    updateState(name, currentValue);\n\n    function getCart() {\n      return currentValue;\n    }\n\n    function updateItem(id, payload) {\n      const index = currentValue.findIndex((item) => item[identifier] === id);\n      if (index === -1) {\n        throw new Error('An element with that identifier was not found');\n      }\n      const newArray = currentValue.map((item, i) => {\n        if (i !== index) return item;\n        return {\n          ...item,\n          ...payload,\n        };\n      });\n      currentValue = newArray;\n      updateState(name, newArray);\n      return newArray;\n    }\n\n    function addItem(payload) {\n      const index = currentValue.findIndex(\n        (item) => payload[identifier] === item[identifier]\n      );\n      if (index !== -1) {\n        throw new Error(\n          'An element with that identifier is already in the cart, you should update it instead'\n        );\n      }\n      let newArray = [...currentValue, payload];\n      currentValue = newArray;\n      updateState(name, newArray);\n      return newArray;\n    }\n\n    function removeItem(id) {\n      const index = currentValue.findIndex((item) => item[identifier] === id);\n      if (index === -1) {\n        throw new Error('An element with that identifier was not found');\n      }\n      let newArray = currentValue.slice();\n      newArray.splice(index, 1);\n      currentValue = newArray;\n      updateState(name, newArray);\n      return newArray;\n    }\n\n    function clearCart() {\n      currentValue = defaultValue;\n      updateState(name, defaultValue);\n    }\n\n    return {\n      getCart,\n      updateItem,\n      addItem,\n      removeItem,\n      clearCart,\n    };\n  }\n\n  function createItem(name, defaultValue = {}) {\n    if (!name) {\n      throw new Error('Name is required for cart to be a part of the store');\n    }\n\n    if (name in state) {\n      throw new Error('Name should be unique');\n    }\n\n    function getItem() {\n      return currentValue;\n    }\n\n    let currentValue = defaultValue;\n    updateState(name, currentValue);\n\n    function updateItem(payload) {\n      const updatedItem = {\n        ...currentValue,\n        ...payload,\n      };\n      currentValue = updatedItem;\n      updateState(name, updatedItem);\n      return updatedItem;\n    }\n\n    function clearItem() {\n      currentValue = defaultValue;\n      updateState(name, defaultValue);\n      return currentValue;\n    }\n\n    return {\n      getItem,\n      updateItem,\n      clearItem,\n    };\n  }\n\n  const store = {\n    getStore,\n    createCart,\n    createItem,\n  };\n\n  return store;\n}\n\nmodule.exports = createStore;\n"],"names":["module","exports","state","updateState","name","payload","updatedState","getStore","createCart","identifier","defaultValue","Error","currentValue","getCart","updateItem","id","index","findIndex","item","newArray","map","i","addItem","removeItem","slice","splice","clearCart","createItem","getItem","updatedItem","clearItem"],"mappings":"gNAwIAA,OAAOC,QAxIP,WACE,IAAIC,EAAQ,GAEZ,SAASC,EAAYC,EAAMC,GACzB,MAAMC,OACDJ,GACHE,CAACA,GAAOC,IAEVH,EAAQI,EA6HV,MANc,CACZC,SArHF,WACE,OAAOL,GAqHPM,WAlHF,SAAoBJ,EAAMK,EAAa,KAAMC,EAAe,IAC1D,IAAKN,EACH,UAAUO,MAAM,uDAGlB,GAAIP,KAAQF,EACV,UAAUS,MAAM,yBAElB,IAAIC,EAAeF,EAwDnB,OAvDAP,EAAYC,EAAMQ,GAuDX,CACLC,QAtDF,WACE,OAAOD,GAsDPE,WAnDF,SAAoBC,EAAIV,GACtB,MAAMW,EAAQJ,EAAaK,UAAWC,GAASA,EAAKT,KAAgBM,GACpE,IAAe,IAAXC,EACF,UAAUL,MAAM,iDAElB,MAAMQ,EAAWP,EAAaQ,IAAI,CAACF,EAAMG,IACnCA,IAAML,EAAcE,OAEnBA,EACAb,IAKP,OAFAO,EAAeO,EACfhB,EAAYC,EAAMe,GACXA,GAsCPG,QAnCF,SAAiBjB,GAIf,IAAe,IAHDO,EAAaK,UACxBC,GAASb,EAAQI,KAAgBS,EAAKT,IAGvC,UAAUE,MACR,wFAGJ,IAAIQ,EAAW,IAAIP,EAAcP,GAGjC,OAFAO,EAAeO,EACfhB,EAAYC,EAAMe,GACXA,GAwBPI,WArBF,SAAoBR,GAClB,MAAMC,EAAQJ,EAAaK,UAAWC,GAASA,EAAKT,KAAgBM,GACpE,IAAe,IAAXC,EACF,UAAUL,MAAM,iDAElB,IAAIQ,EAAWP,EAAaY,QAI5B,OAHAL,EAASM,OAAOT,EAAO,GACvBJ,EAAeO,EACfhB,EAAYC,EAAMe,GACXA,GAaPO,UAVF,WACEd,EAAeF,EACfP,EAAYC,EAAMM,MAsDpBiB,WA1CF,SAAoBvB,EAAMM,EAAe,IACvC,IAAKN,EACH,UAAUO,MAAM,uDAGlB,GAAIP,KAAQF,EACV,UAAUS,MAAM,yBAOlB,IAAIC,EAAeF,EAmBnB,OAlBAP,EAAYC,EAAMQ,GAkBX,CACLgB,QAxBF,WACE,OAAOhB,GAwBPE,WAlBF,SAAoBT,GAClB,MAAMwB,OACDjB,EACAP,GAIL,OAFAO,EAAeiB,EACf1B,EAAYC,EAAMyB,GACXA,GAYPC,UATF,WAGE,OAFAlB,EAAeF,EACfP,EAAYC,EAAMM,GACXE"}